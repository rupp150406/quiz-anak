<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Fruit Selector</title>
    <style>
        @font-face {
            font-family: 'FredokaCustom';
            src: url('fonts/Fredoka-Medium.ttf') format('truetype');
            font-weight: 500;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'FredokaCustom', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            background-image: url('assets/background.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            padding-top: 125px;
        }


        .container {
            width: 100%;
            max-width: 900px;
            position: relative;
            margin-top: 20px;
        }

        .header {
            position: relative;
            margin-bottom: 20px;
        }

        .reset-btn {
            position: absolute;
            top: 0;
            left: 0;
            background: #1185A5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(17, 133, 165, 0.4);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .reset-btn:hover {
            background: #0f7490;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(17, 133, 165, 0.5);
        }

        .reset-btn:active {
            transform: translateY(0);
        }

        .reset-btn img {
            width: 24px;
            height: 24px;
            transition: opacity 0.3s ease;
        }

        .reset-btn.loading img {
            display: none;
        }

        .reset-btn .btn-ellipsis-loader {
            display: none;
            position: relative;
            width: 40px;
            height: 10px;
        }

        .reset-btn.loading .btn-ellipsis-loader {
            display: inline-block;
        }

        .btn-ellipsis-loader div {
            position: absolute;
            top: 0;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }

        .btn-ellipsis-loader div:nth-child(1) {
            left: 0;
            animation: ellipsis1 0.6s infinite;
        }

        .btn-ellipsis-loader div:nth-child(2) {
            left: 0;
            animation: ellipsis2 0.6s infinite;
        }

        .btn-ellipsis-loader div:nth-child(3) {
            left: 16px;
            animation: ellipsis2 0.6s infinite;
        }

        .btn-ellipsis-loader div:nth-child(4) {
            left: 32px;
            animation: ellipsis3 0.6s infinite;
        }

        h1 {
            text-align: center;
            font-size: 48px;
            font-weight: 600;
            background: linear-gradient(135deg, #0C5065 0%, #1DB1E2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 0;
        }

        .fruits-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .fruits-grid.hidden {
            display: none;
        }

        .fruits-grid.pop-up .fruit-card {
            animation: popUp 0.5s ease forwards;
        }

        .fruit-card {
            background: linear-gradient(135deg, #1185A5 0%, #0C5065 100%);
            border-radius: 15px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(17, 133, 165, 0.3);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .fruit-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .fruit-card:hover:not(.disabled)::before {
            opacity: 1;
        }

        .fruit-card:hover:not(.disabled) {
            transform: translateY(-8px);
            box-shadow: 0 12px 35px rgba(17, 133, 165, 0.4);
        }

        .fruit-card:active:not(.disabled) {
            transform: translateY(-4px);
        }

        .fruit-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .fruit-card.disabled:hover {
            transform: none;
            box-shadow: 0 8px 25px rgba(17, 133, 165, 0.3);
        }

        @keyframes popUp {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fruit-card:nth-child(1) {
            animation-delay: 0s;
        }

        .fruit-card:nth-child(2) {
            animation-delay: 0.1s;
        }

        .fruit-card:nth-child(3) {
            animation-delay: 0.2s;
        }

        .fruit-card:nth-child(4) {
            animation-delay: 0.3s;
        }

        .fruit-icon {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            display: block;
            object-fit: contain;
        }

        .cross-icon {
            width: 100px;
            height: 100px;
            display: block;
            margin: 0 auto 15px;
            object-fit: contain;
        }

        .fruit-name {
            font-size: 20px;
            font-weight: 600;
            color: white;
            margin-bottom: 8px;
            text-transform: lowercase;
        }

        .country-name {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        /* Loader Container */
        .loader-container {
            display: none;
            text-align: center;
            margin-top: 40px;
        }

        .loader-container.active {
            display: block;
        }

        .ellipsis-loader {
            display: inline-flex;
            gap: 18px;   /* lebih lega */
            align-items: center;
            justify-content: center;
            margin-top: 70px; /* biar agak turun dikit */
            margin-bottom: 17px; /* biar agak turun dikit */
        }


        .ellipsis-loader div {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            animation: ellipsisAnimation 1.2s infinite ease-in-out;
        }

        .ellipsis-loader div:nth-child(1) {
            background: #0C7694;
            animation-delay: 0s;
        }

        .ellipsis-loader div:nth-child(2) {
            background: #0D6782;
            animation-delay: 0.2s;
        }

        .ellipsis-loader div:nth-child(3) {
            background: #053D4E;
            animation-delay: 0.4s;
        }

        @keyframes ellipsisAnimation {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        @keyframes ellipsis1 {
            0% {
                transform: scale(0);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes ellipsis2 {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(24px, 0);
            }
        }

        @keyframes ellipsis3 {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(0);
            }
        }

        .loading-text {
            font-size: 24px;
            color: #10617C;
            font-weight: 600;
        }

        .main-page.hidden {
            display: none;
        }

        /* Detail Page */
        .detail-page {
            display: none;
            text-align: center;
        }

        .detail-page.active {
            display: block;
        }

        .back-btn {
            background: #1185A5;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(17, 133, 165, 0.4);
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            margin-bottom: 40px;
        }

        .back-btn:hover {
            background: #0f7490;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(17, 133, 165, 0.5);
        }

        .back-btn:active {
            transform: translateY(0);
        }

        .back-btn img {
            width: 24px;
            height: 24px;
        }

        .answer-text {
            font-size: 42px;
            color: #10617C;
            font-weight: 600;
            margin-top: 80px;
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            h1 {
                font-size: 36px;
            }

            .reset-btn {
                padding: 10px 18px;
                font-size: 14px;
            }

            .reset-btn img {
                width: 20px;
                height: 20px;
            }

            .fruits-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
                margin-top: 30px;
            }

            .fruit-card {
                padding: 25px 15px;
                border-radius: 15px;
            }

            .fruit-icon,
            .cross-icon {
                width: 80px;
                height: 80px;
            }

            .fruit-name {
                font-size: 18px;
            }

            .country-name {
                font-size: 14px;
            }

            .loader-container {
                margin-top: 60px;
            }

            .ellipsis-loader div {
                width: 14px;
                height: 14px;
            }

            .loading-text {
                font-size: 20px;
            }

            .answer-text {
                font-size: 32px;
            }

            .back-btn {
                padding: 12px 25px;
                font-size: 16px;
            }

            .back-btn img {
                width: 20px;
                height: 20px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 28px;
            }

            .reset-btn {
                padding: 8px 15px;
                font-size: 12px;
            }

            .reset-btn img {
                width: 18px;
                height: 18px;
            }

            .fruits-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .fruit-card {
                padding: 20px 12px;
                border-radius: 15px;
            }

            .fruit-icon,
            .cross-icon {
                width: 70px;
                height: 70px;
            }

            .fruit-name {
                font-size: 16px;
            }

            .country-name {
                font-size: 13px;
            }

            .loader-container {
                margin-top: 50px;
            }

            .ellipsis-loader div {
                width: 12px;
                height: 12px;
            }

            .loading-text {
                font-size: 18px;
            }

            .answer-text {
                font-size: 26px;
                padding: 0 15px;
            }

            .back-btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .back-btn img {
                width: 18px;
                height: 18px;
            }
        }

        /* Landscape orientation on mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            .fruits-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .fruit-icon,
            .cross-icon {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Main Page -->
        <div class="main-page" id="mainPage">
            <div class="header">
                <button class="reset-btn" id="resetBtn" onclick="resetAll()">
                    <img src="assets/refresh.png" alt="Reset" id="resetIcon">
                    <div class="btn-ellipsis-loader">
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                    <span>Reset</span>
                </button>
                <h1>Choose your fruit</h1>
            </div>

            <!-- Loader -->
            <div class="loader-container" id="loader">
                <div class="ellipsis-loader">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                <div class="loading-text">Loading . . .</div>
            </div>
            
            <div class="fruits-grid" id="fruitsGrid">
                <div class="fruit-card" id="pineapple" onclick="selectFruit('pineapple')">
                    <img src="assets/pineapple.png" alt="Pineapple" class="fruit-icon">
                    <div class="fruit-name">pineapple</div>
                    <div class="country-name" id="pineapple-country"></div>
                </div>
                
                <div class="fruit-card" id="apple" onclick="selectFruit('apple')">
                    <img src="assets/apple.png" alt="Apple" class="fruit-icon">
                    <div class="fruit-name">Apple</div>
                    <div class="country-name" id="apple-country"></div>
                </div>
                
                <div class="fruit-card" id="watermelon" onclick="selectFruit('watermelon')">
                    <img src="assets/watermelon.png" alt="Watermelon" class="fruit-icon">
                    <div class="fruit-name">Watermelon</div>
                    <div class="country-name" id="watermelon-country"></div>
                </div>
                
                <div class="fruit-card" id="orange" onclick="selectFruit('orange')">
                    <img src="assets/orange.png" alt="Orange" class="fruit-icon">
                    <div class="fruit-name">orange</div>
                    <div class="country-name" id="orange-country"></div>
                </div>
            </div>
        </div>

        <!-- Detail Page -->
        <div class="detail-page" id="detailPage">
            <button class="back-btn" onclick="goBack()">
                <img src="assets/arrow.png" alt="Back">
                <span>Back</span>
            </button>
            <div class="answer-text" id="answerText"></div>
        </div>
    </div>

    <script>
        // Store selected fruits
        let selectedFruits = JSON.parse(localStorage.getItem('selectedFruits')) || [];

        // Country list
        const countries = [
            'United States', 'China', 'Japan', 'Germany', 'United Kingdom',
            'France', 'India', 'Italy', 'Brazil', 'Canada',
            'Russia', 'South Korea', 'Australia', 'Spain', 'Mexico',
            'Indonesia', 'Netherlands', 'Saudi Arabia', 'Switzerland', 'Turkey'
        ];

        // Fruit data
        const fruits = {
            pineapple: { icon: 'assets/pineapple.png', name: 'Pineapple', country: '' },
            apple: { icon: 'assets/apple.png', name: 'Apple', country: '' },
            watermelon: { icon: 'assets/watermelon.png', name: 'Watermelon', country: '' },
            orange: { icon: 'assets/orange.png', name: 'Orange', country: '' }
        };

        // Shuffle array using Fisher-Yates algorithm
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Assign random countries to fruits
        function assignRandomCountries() {
            const shuffledCountries = shuffleArray(countries);
            const fruitKeys = Object.keys(fruits);
            
            fruitKeys.forEach((fruit, index) => {
                fruits[fruit].country = shuffledCountries[index];
                const countryElement = document.getElementById(`${fruit}-country`);
                if (countryElement) {
                    countryElement.textContent = fruits[fruit].country;
                }
            });
        }

        // Initialize page
        function init() {
            assignRandomCountries();
            updateMainPage();
            
            // Add pop-up animation on initial load
            const fruitsGrid = document.getElementById('fruitsGrid');
            fruitsGrid.classList.add('pop-up');
            
            setTimeout(() => {
                fruitsGrid.classList.remove('pop-up');
            }, 1000);
        }

        // Update main page to show crosses for selected fruits
        function updateMainPage() {
            selectedFruits.forEach(fruit => {
                const card = document.getElementById(fruit);
                if (card) {
                    card.classList.add('disabled');
                    const iconImg = card.querySelector('.fruit-icon');
                    iconImg.style.display = 'none';
                    
                    // Add cross image if not already added
                    if (!card.querySelector('.cross-icon')) {
                        const crossImg = document.createElement('img');
                        crossImg.className = 'cross-icon';
                        crossImg.src = 'assets/cross.png';
                        crossImg.alt = 'Cross';
                        iconImg.parentNode.insertBefore(crossImg, iconImg);
                    }
                    
                    card.onclick = null;
                }
            });
        }

        // Select a fruit
        function selectFruit(fruitName) {
            // Check if already selected
            if (selectedFruits.includes(fruitName)) {
                return;
            }

            // Show loader and hide fruits grid
            document.getElementById('fruitsGrid').classList.add('hidden');
            document.getElementById('loader').classList.add('active');

            // Wait 1 second then show detail page
            setTimeout(() => {
                // Hide loader
                document.getElementById('loader').classList.remove('active');
                
                // Show detail page
                const fruit = fruits[fruitName];
                document.getElementById('answerText').textContent = `your answer is ${fruit.country}`;
                
                document.getElementById('mainPage').classList.add('hidden');
                document.getElementById('detailPage').classList.add('active');

                // Store current selection temporarily
                sessionStorage.setItem('currentFruit', fruitName);
            }, 1000);
        }

        // Go back to main page
        function goBack() {
            // Hide detail page and show loader
            document.getElementById('detailPage').classList.remove('active');
            document.getElementById('mainPage').classList.remove('hidden');
            document.getElementById('loader').classList.add('active');
            document.getElementById('fruitsGrid').classList.add('hidden');

            // Wait for loader animation
            setTimeout(() => {
                // Get current fruit and mark it as selected
                const currentFruit = sessionStorage.getItem('currentFruit');
                if (currentFruit && !selectedFruits.includes(currentFruit)) {
                    selectedFruits.push(currentFruit);
                    localStorage.setItem('selectedFruits', JSON.stringify(selectedFruits));
                    
                    // Update the card to show cross
                    const card = document.getElementById(currentFruit);
                    card.classList.add('disabled');
                    
                    const iconImg = card.querySelector('.fruit-icon');
                    iconImg.style.display = 'none';
                    
                    // Add cross image
                    const crossImg = document.createElement('img');
                    crossImg.className = 'cross-icon';
                    crossImg.src = 'assets/cross.png';
                    crossImg.alt = 'Cross';
                    iconImg.parentNode.insertBefore(crossImg, iconImg);
                    
                    card.onclick = null;
                }

                // Clear current selection
                sessionStorage.removeItem('currentFruit');

                // Hide loader and show fruits grid
                document.getElementById('loader').classList.remove('active');
                document.getElementById('fruitsGrid').classList.remove('hidden');
            }, 1000);
        }

        // Reset all selections
        function resetAll() {
            const resetBtn = document.getElementById('resetBtn');
            const fruitsGrid = document.getElementById('fruitsGrid');
            
            // Show loader on button
            resetBtn.classList.add('loading');
            resetBtn.disabled = true;

            // Wait for animation effect
            setTimeout(() => {
                // Clear storage
                selectedFruits = [];
                localStorage.removeItem('selectedFruits');
                sessionStorage.removeItem('currentFruit');

                // Randomize countries again
                assignRandomCountries();

                // Reset all cards
                Object.keys(fruits).forEach(fruitName => {
                    const card = document.getElementById(fruitName);
                    const fruit = fruits[fruitName];
                    
                    card.classList.remove('disabled');
                    
                    // Remove cross icon if it exists
                    const crossIcon = card.querySelector('.cross-icon');
                    if (crossIcon) {
                        crossIcon.remove();
                    }
                    
                    // Show the fruit image again
                    const iconImg = card.querySelector('.fruit-icon');
                    iconImg.style.display = 'block';
                    
                    card.onclick = function() { selectFruit(fruitName); };
                });

                // Add pop-up animation
                fruitsGrid.classList.add('pop-up');

                // Remove loader from button
                resetBtn.classList.remove('loading');
                resetBtn.disabled = false;

                // Remove pop-up class after animation
                setTimeout(() => {
                    fruitsGrid.classList.remove('pop-up');
                }, 1000);
            }, 800);
        }

        // Initialize on page load
        init();
    </script>
</body>
</html>